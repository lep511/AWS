Description: (SO0111R) AWS Security Hub Automated Response & Remediation Remediation Roles, v1.5.0
AWSTemplateFormatVersion: "2010-09-09"
Metadata:
  cdk_nag:
    rules_to_suppress:
      - id: AwsSolutions-IAM5
        reason: Resource and action wildcards are needed to remediate findings on arbitrary resources
Parameters:
  SecHubAdminAccount:
    Type: String
    AllowedPattern: \d{12}
    Description: Admin account number
Resources:
  OrchestratorMemberRoleMemberAccountRoleBE9AD9D5:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: SecHubAdminAccount
                    - :role/SO0111-SHARR-Orchestrator-Admin
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
        Version: "2012-10-17"
      Policies:
        - PolicyDocument:
            Statement:
              - Action:
                  - iam:PassRole
                  - iam:GetRole
                Effect: Allow
                Resource:
                  Fn::Join:
                    - ""
                    - - "arn:"
                      - Ref: AWS::Partition
                      - ":iam::"
                      - Ref: AWS::AccountId
                      - :role/SO0111-*
              - Action: ssm:StartAutomationExecution
                Effect: Allow
                Resource:
                  - Fn::Join:
                      - ""
                      - - "arn:"
                        - Ref: AWS::Partition
                        - ":ssm:*:"
                        - Ref: AWS::AccountId
                        - :document/SHARR-*
                  - Fn::Join:
                      - ""
                      - - "arn:"
                        - Ref: AWS::Partition
                        - ":ssm:*:"
                        - Ref: AWS::AccountId
                        - :automation-definition/*
                  - Fn::Join:
                      - ""
                      - - "arn:"
                        - Ref: AWS::Partition
                        - :ssm:*::automation-definition/*
                  - Fn::Join:
                      - ""
                      - - "arn:"
                        - Ref: AWS::Partition
                        - ":ssm:*:"
                        - Ref: AWS::AccountId
                        - :automation-execution/*
              - Action:
                  - ssm:DescribeAutomationExecutions
                  - ssm:GetAutomationExecution
                Effect: Allow
                Resource: "*"
              - Action: ssm:DescribeDocument
                Effect: Allow
                Resource:
                  Fn::Join:
                    - ""
                    - - "arn:"
                      - Ref: AWS::Partition
                      - :ssm:*:*:document/*
              - Action:
                  - ssm:GetParameters
                  - ssm:GetParameter
                Effect: Allow
                Resource:
                  Fn::Join:
                    - ""
                    - - "arn:"
                      - Ref: AWS::Partition
                      - :ssm:*:*:parameter/Solutions/SO0111/*
              - Action: config:DescribeConfigRules
                Effect: Allow
                Resource: "*"
              - Action:
                  - cloudwatch:PutMetricData
                  - securityhub:BatchUpdateFindings
                Effect: Allow
                Resource: "*"
            Version: "2012-10-17"
          PolicyName: member_orchestrator
      RoleName: SO0111-SHARR-Orchestrator-Member
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyCreateCloudTrailMultiRegionTrail59B12044:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - cloudtrail:CreateTrail
              - cloudtrail:UpdateTrail
              - cloudtrail:StartLogging
            Effect: Allow
            Resource: "*"
          - Action:
              - s3:CreateBucket
              - s3:PutEncryptionConfiguration
              - s3:PutBucketPublicAccessBlock
              - s3:PutBucketLogging
              - s3:PutBucketAcl
              - s3:PutBucketPolicy
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - :s3:::so0111-*
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyCreateCloudTrailMultiRegionTrail59B12044
      Roles:
        - Ref: RemediationRoleCreateCloudTrailMultiRegionTrailMemberAccountRoleF70577FF
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions.
  RemediationRoleCreateCloudTrailMultiRegionTrailSHARRMemberBasePolicyA86222AF:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-CreateCloudTrailMultiRegionTrail
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-CreateCloudTrailMultiRegionTrail
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-CreateCloudTrailMultiRegionTrail
        Version: "2012-10-17"
      PolicyName: RemediationRoleCreateCloudTrailMultiRegionTrailSHARRMemberBasePolicyA86222AF
      Roles:
        - Ref: RemediationRoleCreateCloudTrailMultiRegionTrailMemberAccountRoleF70577FF
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole CreateCloudTrailMultiRegionTrail/SHARR-Member-Base-Policy/Resource
  RemediationRoleCreateCloudTrailMultiRegionTrailMemberAccountRoleF70577FF:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-CreateCloudTrailMultiRegionTrail
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyCreateLogMetricFilterAndAlarm102AC980:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - logs:PutMetricFilter
              - cloudwatch:PutMetricAlarm
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":logs:*:"
                    - Ref: AWS::AccountId
                    - :log-group:*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":cloudwatch:*:"
                    - Ref: AWS::AccountId
                    - :alarm:*
          - Action:
              - sns:CreateTopic
              - sns:SetTopicAttributes
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":sns:*:"
                  - Ref: AWS::AccountId
                  - :SO0111-SHARR-LocalAlarmNotification
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyCreateLogMetricFilterAndAlarm102AC980
      Roles:
        - Ref: RemediationRoleCreateLogMetricFilterAndAlarmMemberAccountRoleAA3E3C8A
    Metadata:
      aws:cdk:path: MemberRoleStack/SHARR-Remediation-Policy-CreateLogMetricFilterAndAlarm/Resource
  RemediationRoleCreateLogMetricFilterAndAlarmSHARRMemberBasePolicy2AFEEF94:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-CreateLogMetricFilterAndAlarm
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-CreateLogMetricFilterAndAlarm
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-CreateLogMetricFilterAndAlarm
        Version: "2012-10-17"
      PolicyName: RemediationRoleCreateLogMetricFilterAndAlarmSHARRMemberBasePolicy2AFEEF94
      Roles:
        - Ref: RemediationRoleCreateLogMetricFilterAndAlarmMemberAccountRoleAA3E3C8A
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole CreateLogMetricFilterAndAlarm/SHARR-Member-Base-Policy/Resource
  RemediationRoleCreateLogMetricFilterAndAlarmMemberAccountRoleAA3E3C8A:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-CreateLogMetricFilterAndAlarm
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableAutoScalingGroupELBHealthCheckD6F46CE8:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - autoscaling:UpdateAutoScalingGroup
              - autoscaling:DescribeAutoScalingGroups
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableAutoScalingGroupELBHealthCheckD6F46CE8
      Roles:
        - Ref: RemediationRoleEnableAutoScalingGroupELBHealthCheckMemberAccountRole03AE4AEA
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* ASG.
  RemediationRoleEnableAutoScalingGroupELBHealthCheckSHARRMemberBasePolicy3ED01525:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableAutoScalingGroupELBHealthCheck
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableAutoScalingGroupELBHealthCheck
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableAutoScalingGroupELBHealthCheck
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableAutoScalingGroupELBHealthCheckSHARRMemberBasePolicy3ED01525
      Roles:
        - Ref: RemediationRoleEnableAutoScalingGroupELBHealthCheckMemberAccountRole03AE4AEA
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableAutoScalingGroupELBHealthCheck/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableAutoScalingGroupELBHealthCheckMemberAccountRole03AE4AEA:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableAutoScalingGroupELBHealthCheck
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableAWSConfig8A0259D3:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - iam:GetRole
              - iam:PassRole
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/aws-service-role/config.amazonaws.com/AWSServiceRoleForConfig
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-CreateAccessLoggingBucket
          - Action:
              - sns:CreateTopic
              - sns:SetTopicAttributes
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":sns:*:"
                  - Ref: AWS::AccountId
                  - :SO0111-SHARR-AWSConfigNotification
          - Action: ssm:StartAutomationExecution
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :automation-definition/SHARR-CreateAccessLoggingBucket:*
          - Action:
              - ssm:GetAutomationExecution
              - config:PutConfigurationRecorder
              - config:PutDeliveryChannel
              - config:DescribeConfigurationRecorders
              - config:StartConfigurationRecorder
            Effect: Allow
            Resource: "*"
          - Action:
              - s3:CreateBucket
              - s3:PutEncryptionConfiguration
              - s3:PutBucketPublicAccessBlock
              - s3:PutBucketLogging
              - s3:PutBucketAcl
              - s3:PutBucketPolicy
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - :s3:::so0111-*
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableAWSConfig8A0259D3
      Roles:
        - Ref: RemediationRoleEnableAWSConfigMemberAccountRole3914B25F
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* resource.
  RemediationRoleEnableAWSConfigSHARRMemberBasePolicy535B8C0F:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableAWSConfig
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableAWSConfig
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableAWSConfig
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableAWSConfigSHARRMemberBasePolicy535B8C0F
      Roles:
        - Ref: RemediationRoleEnableAWSConfigMemberAccountRole3914B25F
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableAWSConfig/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableAWSConfigMemberAccountRole3914B25F:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableAWSConfig
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableCloudTrailToCloudWatchLoggingA9BBB945:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action: cloudtrail:UpdateTrail
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":cloudtrail:*:"
                  - Ref: AWS::AccountId
                  - :trail/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::GetAtt:
                - ctcwremediationrole7AB69D0B
                - Arn
          - Action:
              - logs:CreateLogGroup
              - logs:DescribeLogGroups
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableCloudTrailToCloudWatchLoggingA9BBB945
      Roles:
        - Ref: RemediationRoleEnableCloudTrailToCloudWatchLoggingMemberAccountRoleE7E9C206
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow creation and description of any log group
          - id: W28
            reason: Static resource names are required to enable cross-account functionality
  ctcwremediationrole7AB69D0B:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::Join:
                  - ""
                  - - cloudtrail.
                    - Ref: AWS::URLSuffix
        Version: "2012-10-17"
      Policies:
        - PolicyDocument:
            Statement:
              - Action: logs:CreateLogStream
                Effect: Allow
                Resource:
                  Fn::Join:
                    - ""
                    - - "arn:"
                      - Ref: AWS::Partition
                      - :logs:*:*:log-group:*
              - Action: logs:PutLogEvents
                Effect: Allow
                Resource:
                  Fn::Join:
                    - ""
                    - - "arn:"
                      - Ref: AWS::Partition
                      - :logs:*:*:log-group:*:log-stream:*
            Version: "2012-10-17"
          PolicyName: default_lambdaPolicy
      RoleName: SO0111-CloudTrailToCloudWatchLogs
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  RemediationRoleEnableCloudTrailToCloudWatchLoggingSHARRMemberBasePolicy0E4130D5:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableCloudTrailToCloudWatchLogging
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableCloudTrailToCloudWatchLogging
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableCloudTrailToCloudWatchLogging
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableCloudTrailToCloudWatchLoggingSHARRMemberBasePolicy0E4130D5
      Roles:
        - Ref: RemediationRoleEnableCloudTrailToCloudWatchLoggingMemberAccountRoleE7E9C206
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableCloudTrailToCloudWatchLogging/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableCloudTrailToCloudWatchLoggingMemberAccountRoleE7E9C206:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableCloudTrailToCloudWatchLogging
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableCloudTrailEncryption5715DA83:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action: cloudtrail:UpdateTrail
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableCloudTrailEncryption5715DA83
      Roles:
        - Ref: RemediationRoleEnableCloudTrailEncryptionMemberAccountRoleA936699B
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions.
  RemediationRoleEnableCloudTrailEncryptionSHARRMemberBasePolicy6489774E:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableCloudTrailEncryption
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableCloudTrailEncryption
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableCloudTrailEncryption
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableCloudTrailEncryptionSHARRMemberBasePolicy6489774E
      Roles:
        - Ref: RemediationRoleEnableCloudTrailEncryptionMemberAccountRoleA936699B
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableCloudTrailEncryption/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableCloudTrailEncryptionMemberAccountRoleA936699B:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableCloudTrailEncryption
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableDefaultEncryptionS37717FB1C:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - s3:PutEncryptionConfiguration
              - kms:GenerateDataKey
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableDefaultEncryptionS37717FB1C
      Roles:
        - Ref: RemediationRoleEnableDefaultEncryptionS3MemberAccountRoleD9D87C04
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions.
  RemediationRoleEnableDefaultEncryptionS3SHARRMemberBasePolicyB6B36B9A:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableDefaultEncryptionS3
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableDefaultEncryptionS3
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableDefaultEncryptionS3
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableDefaultEncryptionS3SHARRMemberBasePolicyB6B36B9A
      Roles:
        - Ref: RemediationRoleEnableDefaultEncryptionS3MemberAccountRoleD9D87C04
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableDefaultEncryptionS3/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableDefaultEncryptionS3MemberAccountRoleD9D87C04:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableDefaultEncryptionS3
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableVPCFlowLogs22F36069:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action: ec2:CreateFlowLogs
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ec2:*:"
                    - Ref: AWS::AccountId
                    - :vpc/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ec2:*:"
                    - Ref: AWS::AccountId
                    - :vpc-flow-log/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableVPCFlowLogs-remediationRole
          - Action: ssm:GetParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/SO0111/CMK_REMEDIATION_ARN
          - Action:
              - ec2:DescribeFlowLogs
              - logs:CreateLogGroup
              - logs:DescribeLogGroups
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableVPCFlowLogs22F36069
      Roles:
        - Ref: RemediationRoleEnableVPCFlowLogsMemberAccountRoleB79F3729
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* resources.
  EnableVPCFlowLogsremediationrole00848CDF:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: vpc-flow-logs.amazonaws.com
        Version: "2012-10-17"
      Policies:
        - PolicyDocument:
            Statement:
              - Action:
                  - logs:CreateLogGroup
                  - logs:CreateLogStream
                  - logs:DescribeLogGroups
                  - logs:DescribeLogStreams
                  - logs:PutLogEvents
                Effect: Allow
                Resource: "*"
            Version: "2012-10-17"
          PolicyName: default_lambdaPolicy
      RoleName: SO0111-EnableVPCFlowLogs-remediationRole
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  RemediationRoleEnableVPCFlowLogsSHARRMemberBasePolicy0D33A918:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableVPCFlowLogs
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableVPCFlowLogs
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableVPCFlowLogs
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableVPCFlowLogsSHARRMemberBasePolicy0D33A918
      Roles:
        - Ref: RemediationRoleEnableVPCFlowLogsMemberAccountRoleB79F3729
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableVPCFlowLogs/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableVPCFlowLogsMemberAccountRoleB79F3729:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableVPCFlowLogs
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyCreateAccessLoggingBucket4A1677D6:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - s3:CreateBucket
              - s3:PutEncryptionConfiguration
              - s3:PutBucketAcl
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyCreateAccessLoggingBucket4A1677D6
      Roles:
        - Ref: RemediationRoleCreateAccessLoggingBucketMemberAccountRole3E1569D8
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* resources.
  RemediationRoleCreateAccessLoggingBucketSHARRMemberBasePolicy0B9908F2:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-CreateAccessLoggingBucket
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-CreateAccessLoggingBucket
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-CreateAccessLoggingBucket
        Version: "2012-10-17"
      PolicyName: RemediationRoleCreateAccessLoggingBucketSHARRMemberBasePolicy0B9908F2
      Roles:
        - Ref: RemediationRoleCreateAccessLoggingBucketMemberAccountRole3E1569D8
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole CreateAccessLoggingBucket/SHARR-Member-Base-Policy/Resource
  RemediationRoleCreateAccessLoggingBucketMemberAccountRole3E1569D8:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-CreateAccessLoggingBucket
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyMakeEBSSnapshotsPrivate64D2F13D:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ec2:ModifySnapshotAttribute
              - ec2:DescribeSnapshots
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyMakeEBSSnapshotsPrivate64D2F13D
      Roles:
        - Ref: RemediationRoleMakeEBSSnapshotsPrivateMemberAccountRoleFA05CFAF
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* snapshot.
  RemediationRoleMakeEBSSnapshotsPrivateSHARRMemberBasePolicy7DE85B9C:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-MakeEBSSnapshotsPrivate
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-MakeEBSSnapshotsPrivate
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-MakeEBSSnapshotsPrivate
        Version: "2012-10-17"
      PolicyName: RemediationRoleMakeEBSSnapshotsPrivateSHARRMemberBasePolicy7DE85B9C
      Roles:
        - Ref: RemediationRoleMakeEBSSnapshotsPrivateMemberAccountRoleFA05CFAF
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole MakeEBSSnapshotsPrivate/SHARR-Member-Base-Policy/Resource
  RemediationRoleMakeEBSSnapshotsPrivateMemberAccountRoleFA05CFAF:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-MakeEBSSnapshotsPrivate
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyMakeRDSSnapshotPrivate26FDF037:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - rds:ModifyDBSnapshotAttribute
              - rds:ModifyDBClusterSnapshotAttribute
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyMakeRDSSnapshotPrivate26FDF037
      Roles:
        - Ref: RemediationRoleMakeRDSSnapshotPrivateMemberAccountRole6760FE6D
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* snapshot.
  RemediationRoleMakeRDSSnapshotPrivateSHARRMemberBasePolicyFF0FBF31:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-MakeRDSSnapshotPrivate
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-MakeRDSSnapshotPrivate
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-MakeRDSSnapshotPrivate
        Version: "2012-10-17"
      PolicyName: RemediationRoleMakeRDSSnapshotPrivateSHARRMemberBasePolicyFF0FBF31
      Roles:
        - Ref: RemediationRoleMakeRDSSnapshotPrivateMemberAccountRole6760FE6D
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole MakeRDSSnapshotPrivate/SHARR-Member-Base-Policy/Resource
  RemediationRoleMakeRDSSnapshotPrivateMemberAccountRole6760FE6D:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-MakeRDSSnapshotPrivate
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyRemoveLambdaPublicAccessDD6213D0:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - lambda:GetPolicy
              - lambda:RemovePermission
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyRemoveLambdaPublicAccessDD6213D0
      Roles:
        - Ref: RemediationRoleRemoveLambdaPublicAccessMemberAccountRoleB266862C
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for any resource.
  RemediationRoleRemoveLambdaPublicAccessSHARRMemberBasePolicy6AACE4BE:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-RemoveLambdaPublicAccess
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-RemoveLambdaPublicAccess
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-RemoveLambdaPublicAccess
        Version: "2012-10-17"
      PolicyName: RemediationRoleRemoveLambdaPublicAccessSHARRMemberBasePolicy6AACE4BE
      Roles:
        - Ref: RemediationRoleRemoveLambdaPublicAccessMemberAccountRoleB266862C
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole RemoveLambdaPublicAccess/SHARR-Member-Base-Policy/Resource
  RemediationRoleRemoveLambdaPublicAccessMemberAccountRoleB266862C:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-RemoveLambdaPublicAccess
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyRevokeUnrotatedKeys7F92ECED:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - iam:UpdateAccessKey
              - iam:ListAccessKeys
              - iam:GetAccessKeyLastUsed
              - iam:GetUser
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :user/*
          - Action: config:ListDiscoveredResources
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyRevokeUnrotatedKeys7F92ECED
      Roles:
        - Ref: RemediationRoleRevokeUnrotatedKeysMemberAccountRoleBC193A84
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for any resource.
  RemediationRoleRevokeUnrotatedKeysSHARRMemberBasePolicy493293CA:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-RevokeUnrotatedKeys
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-RevokeUnrotatedKeys
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-RevokeUnrotatedKeys
        Version: "2012-10-17"
      PolicyName: RemediationRoleRevokeUnrotatedKeysSHARRMemberBasePolicy493293CA
      Roles:
        - Ref: RemediationRoleRevokeUnrotatedKeysMemberAccountRoleBC193A84
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole RevokeUnrotatedKeys/SHARR-Member-Base-Policy/Resource
  RemediationRoleRevokeUnrotatedKeysMemberAccountRoleBC193A84:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-RevokeUnrotatedKeys
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicySetSSLBucketPolicy2B2017FE:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - s3:GetBucketPolicy
              - s3:PutBucketPolicy
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicySetSSLBucketPolicy2B2017FE
      Roles:
        - Ref: RemediationRoleSetSSLBucketPolicyMemberAccountRoleD6BB5274
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* resource.
  RemediationRoleSetSSLBucketPolicySHARRMemberBasePolicy21EBF952:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-SetSSLBucketPolicy
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-SetSSLBucketPolicy
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-SetSSLBucketPolicy
        Version: "2012-10-17"
      PolicyName: RemediationRoleSetSSLBucketPolicySHARRMemberBasePolicy21EBF952
      Roles:
        - Ref: RemediationRoleSetSSLBucketPolicyMemberAccountRoleD6BB5274
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole SetSSLBucketPolicy/SHARR-Member-Base-Policy/Resource
  RemediationRoleSetSSLBucketPolicyMemberAccountRoleD6BB5274:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-SetSSLBucketPolicy
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyReplaceCodeBuildClearTextCredentials399A9B2A:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - codeBuild:BatchGetProjects
              - codeBuild:UpdateProject
              - ssm:PutParameter
              - iam:CreatePolicy
            Effect: Allow
            Resource: "*"
          - Action: iam:AttachRolePolicy
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/service-role/*
          - Action: iam:AttachRolePolicy
            Effect: Deny
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-ReplaceCodeBuildClearTextCredentials
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyReplaceCodeBuildClearTextCredentials399A9B2A
      Roles:
        - Ref: RemediationRoleReplaceCodeBuildClearTextCredentialsMemberAccountRoleAEEA6C96
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* resource.
  RemediationRoleReplaceCodeBuildClearTextCredentialsSHARRMemberBasePolicy93CBC55E:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-ReplaceCodeBuildClearTextCredentials
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-ReplaceCodeBuildClearTextCredentials
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-ReplaceCodeBuildClearTextCredentials
        Version: "2012-10-17"
      PolicyName: RemediationRoleReplaceCodeBuildClearTextCredentialsSHARRMemberBasePolicy93CBC55E
      Roles:
        - Ref: RemediationRoleReplaceCodeBuildClearTextCredentialsMemberAccountRoleAEEA6C96
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole ReplaceCodeBuildClearTextCredentials/SHARR-Member-Base-Policy/Resource
  RemediationRoleReplaceCodeBuildClearTextCredentialsMemberAccountRoleAEEA6C96:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-ReplaceCodeBuildClearTextCredentials
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyS3BlockDenylist2115A636:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - s3:PutBucketPolicy
              - s3:GetBucketPolicy
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyS3BlockDenylist2115A636
      Roles:
        - Ref: RemediationRoleS3BlockDenylistMemberAccountRoleDFABBAB3
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* resource.
  RemediationRoleS3BlockDenylistSHARRMemberBasePolicyFEAC9691:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-S3BlockDenylist
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-S3BlockDenylist
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-S3BlockDenylist
        Version: "2012-10-17"
      PolicyName: RemediationRoleS3BlockDenylistSHARRMemberBasePolicyFEAC9691
      Roles:
        - Ref: RemediationRoleS3BlockDenylistMemberAccountRoleDFABBAB3
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole S3BlockDenylist/SHARR-Member-Base-Policy/Resource
  RemediationRoleS3BlockDenylistMemberAccountRoleDFABBAB3:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-S3BlockDenylist
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEncryptRDSSnapshot27491BE0:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - rds:CopyDBSnapshot
              - rds:CopyDBClusterSnapshot
              - rds:DescribeDBSnapshots
              - rds:DescribeDBClusterSnapshots
              - rds:DeleteDBSnapshot
              - rds:DeleteDBClusterSnapshots
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEncryptRDSSnapshot27491BE0
      Roles:
        - Ref: RemediationRoleEncryptRDSSnapshotMemberAccountRole5D2C905F
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* resource.
  RemediationRoleEncryptRDSSnapshotSHARRMemberBasePolicyB377E8DA:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EncryptRDSSnapshot
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EncryptRDSSnapshot
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EncryptRDSSnapshot
        Version: "2012-10-17"
      PolicyName: RemediationRoleEncryptRDSSnapshotSHARRMemberBasePolicyB377E8DA
      Roles:
        - Ref: RemediationRoleEncryptRDSSnapshotMemberAccountRole5D2C905F
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EncryptRDSSnapshot/SHARR-Member-Base-Policy/Resource
  RemediationRoleEncryptRDSSnapshotMemberAccountRole5D2C905F:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EncryptRDSSnapshot
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyDisablePublicAccessToRedshiftCluster6F8CE9CA:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - redshift:ModifyCluster
              - redshift:DescribeClusters
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyDisablePublicAccessToRedshiftCluster6F8CE9CA
      Roles:
        - Ref: RemediationRoleDisablePublicAccessToRedshiftClusterMemberAccountRole87AA27A6
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for any resource.
  RemediationRoleDisablePublicAccessToRedshiftClusterSHARRMemberBasePolicy071786CD:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-DisablePublicAccessToRedshiftCluster
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-DisablePublicAccessToRedshiftCluster
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-DisablePublicAccessToRedshiftCluster
        Version: "2012-10-17"
      PolicyName: RemediationRoleDisablePublicAccessToRedshiftClusterSHARRMemberBasePolicy071786CD
      Roles:
        - Ref: RemediationRoleDisablePublicAccessToRedshiftClusterMemberAccountRole87AA27A6
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole DisablePublicAccessToRedshiftCluster/SHARR-Member-Base-Policy/Resource
  RemediationRoleDisablePublicAccessToRedshiftClusterMemberAccountRole87AA27A6:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-DisablePublicAccessToRedshiftCluster
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableRedshiftClusterAuditLogging37BC8505:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - redshift:DescribeLoggingStatus
              - redshift:EnableLogging
              - s3:PutObject
            Effect: Allow
            Resource:
              - "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableRedshiftClusterAuditLogging37BC8505
      Roles:
        - Ref: RemediationRoleEnableRedshiftClusterAuditLoggingMemberAccountRoleD7AC224E
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for any resource.
  RemediationRoleEnableRedshiftClusterAuditLoggingSHARRMemberBasePolicyFB2EC252:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableRedshiftClusterAuditLogging
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableRedshiftClusterAuditLogging
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableRedshiftClusterAuditLogging
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableRedshiftClusterAuditLoggingSHARRMemberBasePolicyFB2EC252
      Roles:
        - Ref: RemediationRoleEnableRedshiftClusterAuditLoggingMemberAccountRoleD7AC224E
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableRedshiftClusterAuditLogging/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableRedshiftClusterAuditLoggingMemberAccountRoleD7AC224E:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableRedshiftClusterAuditLogging
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableAutomaticVersionUpgradeOnRedshiftCluster4644F616:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - redshift:ModifyCluster
              - redshift:DescribeClusters
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableAutomaticVersionUpgradeOnRedshiftCluster4644F616
      Roles:
        - Ref: RemediationRoleEnableAutomaticVersionUpgradeOnRedshiftClusterMemberAccountRoleADCE761E
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for any resource.
  RemediationRoleEnableAutomaticVersionUpgradeOnRedshiftClusterSHARRMemberBasePolicyFEA51B64:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableAutomaticVersionUpgradeOnRedshiftCluster
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableAutomaticVersionUpgradeOnRedshiftCluster
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableAutomaticVersionUpgradeOnRedshiftCluster
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableAutomaticVersionUpgradeOnRedshiftClusterSHARRMemberBasePolicyFEA51B64
      Roles:
        - Ref: RemediationRoleEnableAutomaticVersionUpgradeOnRedshiftClusterMemberAccountRoleADCE761E
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableAutomaticVersionUpgradeOnRedshiftCluster/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableAutomaticVersionUpgradeOnRedshiftClusterMemberAccountRoleADCE761E:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableAutomaticVersionUpgradeOnRedshiftCluster
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableAutomaticSnapshotsOnRedshiftCluster2DE51374:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - redshift:ModifyCluster
              - redshift:DescribeClusters
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableAutomaticSnapshotsOnRedshiftCluster2DE51374
      Roles:
        - Ref: RemediationRoleEnableAutomaticSnapshotsOnRedshiftClusterMemberAccountRole13857606
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for any resource.
  RemediationRoleEnableAutomaticSnapshotsOnRedshiftClusterSHARRMemberBasePolicyB55A3D11:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableAutomaticSnapshotsOnRedshiftCluster
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableAutomaticSnapshotsOnRedshiftCluster
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableAutomaticSnapshotsOnRedshiftCluster
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableAutomaticSnapshotsOnRedshiftClusterSHARRMemberBasePolicyB55A3D11
      Roles:
        - Ref: RemediationRoleEnableAutomaticSnapshotsOnRedshiftClusterMemberAccountRole13857606
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableAutomaticSnapshotsOnRedshiftCluster/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableAutomaticSnapshotsOnRedshiftClusterMemberAccountRole13857606:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableAutomaticSnapshotsOnRedshiftCluster
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyConfigureS3BucketLogging9F85EEE2:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - s3:PutBucketLogging
              - s3:CreateBucket
              - s3:PutEncryptionConfiguration
              - s3:PutBucketAcl
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyConfigureS3BucketLogging9F85EEE2
      Roles:
        - Ref: RemediationRoleConfigureS3BucketLoggingMemberAccountRoleE068390D
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* resource.
  RemediationRoleConfigureS3BucketLoggingSHARRMemberBasePolicyAC4F82A8:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-ConfigureS3BucketLogging
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-ConfigureS3BucketLogging
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-ConfigureS3BucketLogging
        Version: "2012-10-17"
      PolicyName: RemediationRoleConfigureS3BucketLoggingSHARRMemberBasePolicyAC4F82A8
      Roles:
        - Ref: RemediationRoleConfigureS3BucketLoggingMemberAccountRoleE068390D
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole ConfigureS3BucketLogging/SHARR-Member-Base-Policy/Resource
  RemediationRoleConfigureS3BucketLoggingMemberAccountRoleE068390D:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-ConfigureS3BucketLogging
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyDisablePublicAccessForSecurityGroupE214EF9A:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ec2:DescribeSecurityGroupReferences
              - ec2:DescribeSecurityGroups
              - ec2:UpdateSecurityGroupRuleDescriptionsEgress
              - ec2:UpdateSecurityGroupRuleDescriptionsIngress
              - ec2:RevokeSecurityGroupIngress
              - ec2:RevokeSecurityGroupEgress
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyDisablePublicAccessForSecurityGroupE214EF9A
      Roles:
        - Ref: RemediationRoleDisablePublicAccessForSecurityGroupMemberAccountRole3BED8BF4
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* resource.
  RemediationRoleDisablePublicAccessForSecurityGroupSHARRMemberBasePolicy3076FC8A:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-DisablePublicAccessForSecurityGroup
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-DisablePublicAccessForSecurityGroup
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-DisablePublicAccessForSecurityGroup
        Version: "2012-10-17"
      PolicyName: RemediationRoleDisablePublicAccessForSecurityGroupSHARRMemberBasePolicy3076FC8A
      Roles:
        - Ref: RemediationRoleDisablePublicAccessForSecurityGroupMemberAccountRole3BED8BF4
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole DisablePublicAccessForSecurityGroup/SHARR-Member-Base-Policy/Resource
  RemediationRoleDisablePublicAccessForSecurityGroupMemberAccountRole3BED8BF4:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-DisablePublicAccessForSecurityGroup
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyConfigureS3BucketPublicAccessBlock2E4EF13D:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - s3:PutBucketPublicAccessBlock
              - s3:GetBucketPublicAccessBlock
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyConfigureS3BucketPublicAccessBlock2E4EF13D
      Roles:
        - Ref: RemediationRoleConfigureS3BucketPublicAccessBlockMemberAccountRoleC78F6EE7
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* resource.
  RemediationRoleConfigureS3BucketPublicAccessBlockSHARRMemberBasePolicyB9DCBD99:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-ConfigureS3BucketPublicAccessBlock
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-ConfigureS3BucketPublicAccessBlock
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-ConfigureS3BucketPublicAccessBlock
        Version: "2012-10-17"
      PolicyName: RemediationRoleConfigureS3BucketPublicAccessBlockSHARRMemberBasePolicyB9DCBD99
      Roles:
        - Ref: RemediationRoleConfigureS3BucketPublicAccessBlockMemberAccountRoleC78F6EE7
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole ConfigureS3BucketPublicAccessBlock/SHARR-Member-Base-Policy/Resource
  RemediationRoleConfigureS3BucketPublicAccessBlockMemberAccountRoleC78F6EE7:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-ConfigureS3BucketPublicAccessBlock
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyConfigureS3PublicAccessBlockEAD9CA55:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - s3:PutAccountPublicAccessBlock
              - s3:GetAccountPublicAccessBlock
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyConfigureS3PublicAccessBlockEAD9CA55
      Roles:
        - Ref: RemediationRoleConfigureS3PublicAccessBlockMemberAccountRole98A4BC1D
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* resource.
  RemediationRoleConfigureS3PublicAccessBlockSHARRMemberBasePolicy26BF29A6:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-ConfigureS3PublicAccessBlock
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-ConfigureS3PublicAccessBlock
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-ConfigureS3PublicAccessBlock
        Version: "2012-10-17"
      PolicyName: RemediationRoleConfigureS3PublicAccessBlockSHARRMemberBasePolicy26BF29A6
      Roles:
        - Ref: RemediationRoleConfigureS3PublicAccessBlockMemberAccountRole98A4BC1D
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole ConfigureS3PublicAccessBlock/SHARR-Member-Base-Policy/Resource
  RemediationRoleConfigureS3PublicAccessBlockMemberAccountRole98A4BC1D:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-ConfigureS3PublicAccessBlock
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableCloudTrailLogFileValidation00359A88:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - cloudtrail:UpdateTrail
              - cloudtrail:GetTrail
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":cloudtrail:*:"
                  - Ref: AWS::AccountId
                  - :trail/*
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableCloudTrailLogFileValidation00359A88
      Roles:
        - Ref: RemediationRoleEnableCloudTrailLogFileValidationMemberAccountRole3F5F7157
    Metadata:
      aws:cdk:path: MemberRoleStack/SHARR-Remediation-Policy-EnableCloudTrailLogFileValidation/Resource
  RemediationRoleEnableCloudTrailLogFileValidationSHARRMemberBasePolicy85A07C2D:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableCloudTrailLogFileValidation
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableCloudTrailLogFileValidation
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableCloudTrailLogFileValidation
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableCloudTrailLogFileValidationSHARRMemberBasePolicy85A07C2D
      Roles:
        - Ref: RemediationRoleEnableCloudTrailLogFileValidationMemberAccountRole3F5F7157
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableCloudTrailLogFileValidation/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableCloudTrailLogFileValidationMemberAccountRole3F5F7157:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableCloudTrailLogFileValidation
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableEbsEncryptionByDefaultED8BC775:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ec2:EnableEBSEncryptionByDefault
              - ec2:GetEbsEncryptionByDefault
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableEbsEncryptionByDefaultED8BC775
      Roles:
        - Ref: RemediationRoleEnableEbsEncryptionByDefaultMemberAccountRoleDF17FF59
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* resource.
  RemediationRoleEnableEbsEncryptionByDefaultSHARRMemberBasePolicy77CF4834:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableEbsEncryptionByDefault
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableEbsEncryptionByDefault
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableEbsEncryptionByDefault
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableEbsEncryptionByDefaultSHARRMemberBasePolicy77CF4834
      Roles:
        - Ref: RemediationRoleEnableEbsEncryptionByDefaultMemberAccountRoleDF17FF59
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableEbsEncryptionByDefault/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableEbsEncryptionByDefaultMemberAccountRoleDF17FF59:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableEbsEncryptionByDefault
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableEnhancedMonitoringOnRDSInstance6E7C63B0:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - iam:GetRole
              - iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-RDSMonitoring-remediationRole
          - Action:
              - rds:DescribeDBInstances
              - rds:ModifyDBInstance
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableEnhancedMonitoringOnRDSInstance6E7C63B0
      Roles:
        - Ref: RemediationRoleEnableEnhancedMonitoringOnRDSInstanceMemberAccountRoleB3EFCB99
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* RDS database.
  RemediationRoleEnableEnhancedMonitoringOnRDSInstanceSHARRMemberBasePolicy4D03FBD0:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableEnhancedMonitoringOnRDSInstance
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableEnhancedMonitoringOnRDSInstance
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableEnhancedMonitoringOnRDSInstance
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableEnhancedMonitoringOnRDSInstanceSHARRMemberBasePolicy4D03FBD0
      Roles:
        - Ref: RemediationRoleEnableEnhancedMonitoringOnRDSInstanceMemberAccountRoleB3EFCB99
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableEnhancedMonitoringOnRDSInstance/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableEnhancedMonitoringOnRDSInstanceMemberAccountRoleB3EFCB99:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableEnhancedMonitoringOnRDSInstance
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  Rds6EnhancedMonitoringRoleRDS6EnhancedMonitoringPolicyA2EB4EE9:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - logs:CreateLogGroup
              - logs:PutRetentionPolicy
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":logs:*:"
                  - Ref: AWS::AccountId
                  - :log-group:RDS*
            Sid: EnableCreationAndManagementOfRDSCloudwatchLogGroups
          - Action:
              - logs:CreateLogStream
              - logs:PutLogEvents
              - logs:DescribeLogStreams
              - logs:GetLogEvents
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":logs:*:"
                  - Ref: AWS::AccountId
                  - :log-group:RDS*:log-stream:*
            Sid: EnableCreationAndManagementOfRDSCloudwatchLogStreams
        Version: "2012-10-17"
      PolicyName: Rds6EnhancedMonitoringRoleRDS6EnhancedMonitoringPolicyA2EB4EE9
      Roles:
        - Ref: Rds6EnhancedMonitoringRole2FD1E9A5
    Metadata:
      aws:cdk:path: MemberRoleStack/Rds6EnhancedMonitoringRole/RDS6-Enhanced-Monitoring-Policy/Resource
  Rds6EnhancedMonitoringRole2FD1E9A5:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: monitoring.rds.amazonaws.com
        Version: "2012-10-17"
      RoleName: SO0111-RDSMonitoring-remediationRole
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W28
            reason: Static names required to allow use in automated remediation runbooks.
  SHARRRemediationPolicyEnableKeyRotation7DBFDFE8:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - kms:EnableKeyRotation
              - kms:GetKeyRotationStatus
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableKeyRotation7DBFDFE8
      Roles:
        - Ref: RemediationRoleEnableKeyRotationMemberAccountRole2366F17F
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* resource.
  RemediationRoleEnableKeyRotationSHARRMemberBasePolicyA6E832D4:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableKeyRotation
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableKeyRotation
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableKeyRotation
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableKeyRotationSHARRMemberBasePolicyA6E832D4
      Roles:
        - Ref: RemediationRoleEnableKeyRotationMemberAccountRole2366F17F
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableKeyRotation/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableKeyRotationMemberAccountRole2366F17F:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableKeyRotation
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableRDSClusterDeletionProtectionBC66754B:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action: iam:GetRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/RDSEnhancedMonitoringRole
          - Action: config:GetResourceConfigHistory
            Effect: Allow
            Resource: "*"
          - Action:
              - rds:DescribeDBClusters
              - rds:ModifyDBCluster
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableRDSClusterDeletionProtectionBC66754B
      Roles:
        - Ref: RemediationRoleEnableRDSClusterDeletionProtectionMemberAccountRole019A1667
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* RDS database.
  RemediationRoleEnableRDSClusterDeletionProtectionSHARRMemberBasePolicy90D2EA44:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableRDSClusterDeletionProtection
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableRDSClusterDeletionProtection
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableRDSClusterDeletionProtection
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableRDSClusterDeletionProtectionSHARRMemberBasePolicy90D2EA44
      Roles:
        - Ref: RemediationRoleEnableRDSClusterDeletionProtectionMemberAccountRole019A1667
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableRDSClusterDeletionProtection/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableRDSClusterDeletionProtectionMemberAccountRole019A1667:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableRDSClusterDeletionProtection
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableCopyTagsToSnapshotOnRDSClusterC9C3E856:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action: iam:GetRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/RDSEnhancedMonitoringRole
          - Action: config:GetResourceConfigHistory
            Effect: Allow
            Resource: "*"
          - Action:
              - rds:DescribeDBClusters
              - rds:ModifyDBCluster
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableCopyTagsToSnapshotOnRDSClusterC9C3E856
      Roles:
        - Ref: RemediationRoleEnableCopyTagsToSnapshotOnRDSClusterMemberAccountRole026ECDEE
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* RDS database.
  RemediationRoleEnableCopyTagsToSnapshotOnRDSClusterSHARRMemberBasePolicy5F24C304:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableCopyTagsToSnapshotOnRDSCluster
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableCopyTagsToSnapshotOnRDSCluster
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableCopyTagsToSnapshotOnRDSCluster
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableCopyTagsToSnapshotOnRDSClusterSHARRMemberBasePolicy5F24C304
      Roles:
        - Ref: RemediationRoleEnableCopyTagsToSnapshotOnRDSClusterMemberAccountRole026ECDEE
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableCopyTagsToSnapshotOnRDSCluster/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableCopyTagsToSnapshotOnRDSClusterMemberAccountRole026ECDEE:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableCopyTagsToSnapshotOnRDSCluster
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableRDSInstanceDeletionProtection908386A3:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - rds:DescribeDBInstances
              - rds:ModifyDBInstance
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableRDSInstanceDeletionProtection908386A3
      Roles:
        - Ref: RemediationRoleEnableRDSInstanceDeletionProtectionMemberAccountRole105E9511
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* RDS database.
  RemediationRoleEnableRDSInstanceDeletionProtectionSHARRMemberBasePolicy5071CD93:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableRDSInstanceDeletionProtection
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableRDSInstanceDeletionProtection
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableRDSInstanceDeletionProtection
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableRDSInstanceDeletionProtectionSHARRMemberBasePolicy5071CD93
      Roles:
        - Ref: RemediationRoleEnableRDSInstanceDeletionProtectionMemberAccountRole105E9511
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableRDSInstanceDeletionProtection/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableRDSInstanceDeletionProtectionMemberAccountRole105E9511:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableRDSInstanceDeletionProtection
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableMultiAZOnRDSInstance3A3D7BEA:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - rds:DescribeDBInstances
              - rds:ModifyDBInstance
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableMultiAZOnRDSInstance3A3D7BEA
      Roles:
        - Ref: RemediationRoleEnableMultiAZOnRDSInstanceMemberAccountRoleE0F45AF6
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for *any* RDS database.
  RemediationRoleEnableMultiAZOnRDSInstanceSHARRMemberBasePolicy1DE61917:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableMultiAZOnRDSInstance
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableMultiAZOnRDSInstance
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableMultiAZOnRDSInstance
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableMultiAZOnRDSInstanceSHARRMemberBasePolicy1DE61917
      Roles:
        - Ref: RemediationRoleEnableMultiAZOnRDSInstanceMemberAccountRoleE0F45AF6
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableMultiAZOnRDSInstance/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableMultiAZOnRDSInstanceMemberAccountRoleE0F45AF6:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableMultiAZOnRDSInstance
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyRemoveVPCDefaultSecurityGroupRules94040124:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ec2:UpdateSecurityGroupRuleDescriptionsEgress
              - ec2:UpdateSecurityGroupRuleDescriptionsIngress
              - ec2:RevokeSecurityGroupIngress
              - ec2:RevokeSecurityGroupEgress
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ec2:*:"
                  - Ref: AWS::AccountId
                  - :security-group/*
          - Action:
              - ec2:DescribeSecurityGroupReferences
              - ec2:DescribeSecurityGroups
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyRemoveVPCDefaultSecurityGroupRules94040124
      Roles:
        - Ref: RemediationRoleRemoveVPCDefaultSecurityGroupRulesMemberAccountRole406D320B
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for any resource.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  RemediationRoleRemoveVPCDefaultSecurityGroupRulesSHARRMemberBasePolicy18B08253:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-RemoveVPCDefaultSecurityGroupRules
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-RemoveVPCDefaultSecurityGroupRules
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-RemoveVPCDefaultSecurityGroupRules
        Version: "2012-10-17"
      PolicyName: RemediationRoleRemoveVPCDefaultSecurityGroupRulesSHARRMemberBasePolicy18B08253
      Roles:
        - Ref: RemediationRoleRemoveVPCDefaultSecurityGroupRulesMemberAccountRole406D320B
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole RemoveVPCDefaultSecurityGroupRules/SHARR-Member-Base-Policy/Resource
  RemediationRoleRemoveVPCDefaultSecurityGroupRulesMemberAccountRole406D320B:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-RemoveVPCDefaultSecurityGroupRules
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyRevokeUnusedIAMUserCredentialsEEF45939:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - iam:UpdateAccessKey
              - iam:ListAccessKeys
              - iam:GetAccessKeyLastUsed
              - iam:GetUser
              - iam:GetLoginProfile
              - iam:DeleteLoginProfile
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :user/*
          - Action: config:ListDiscoveredResources
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyRevokeUnusedIAMUserCredentialsEEF45939
      Roles:
        - Ref: RemediationRoleRevokeUnusedIAMUserCredentialsMemberAccountRole5C008B43
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for any resource.
  RemediationRoleRevokeUnusedIAMUserCredentialsSHARRMemberBasePolicy6519E750:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-RevokeUnusedIAMUserCredentials
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-RevokeUnusedIAMUserCredentials
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-RevokeUnusedIAMUserCredentials
        Version: "2012-10-17"
      PolicyName: RemediationRoleRevokeUnusedIAMUserCredentialsSHARRMemberBasePolicy6519E750
      Roles:
        - Ref: RemediationRoleRevokeUnusedIAMUserCredentialsMemberAccountRole5C008B43
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole RevokeUnusedIAMUserCredentials/SHARR-Member-Base-Policy/Resource
  RemediationRoleRevokeUnusedIAMUserCredentialsMemberAccountRole5C008B43:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-RevokeUnusedIAMUserCredentials
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicySetIAMPasswordPolicy044BED0C:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - iam:UpdateAccountPasswordPolicy
              - iam:GetAccountPasswordPolicy
              - ec2:UpdateSecurityGroupRuleDescriptionsIngress
              - ec2:RevokeSecurityGroupIngress
              - ec2:RevokeSecurityGroupEgress
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicySetIAMPasswordPolicy044BED0C
      Roles:
        - Ref: RemediationRoleSetIAMPasswordPolicyMemberAccountRoleA1FF47B4
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for any resource.
  RemediationRoleSetIAMPasswordPolicySHARRMemberBasePolicy3E89D2C9:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-SetIAMPasswordPolicy
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-SetIAMPasswordPolicy
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-SetIAMPasswordPolicy
        Version: "2012-10-17"
      PolicyName: RemediationRoleSetIAMPasswordPolicySHARRMemberBasePolicy3E89D2C9
      Roles:
        - Ref: RemediationRoleSetIAMPasswordPolicyMemberAccountRoleA1FF47B4
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole SetIAMPasswordPolicy/SHARR-Member-Base-Policy/Resource
  RemediationRoleSetIAMPasswordPolicyMemberAccountRoleA1FF47B4:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-SetIAMPasswordPolicy
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyDisablePublicAccessToRDSInstance0F21A96A:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - rds:DescribeDBInstances
              - rds:ModifyDBInstance
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyDisablePublicAccessToRDSInstance0F21A96A
      Roles:
        - Ref: RemediationRoleDisablePublicAccessToRDSInstanceMemberAccountRole7E0A6680
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for any resource.
  RemediationRoleDisablePublicAccessToRDSInstanceSHARRMemberBasePolicyD50CB3CA:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-DisablePublicAccessToRDSInstance
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-DisablePublicAccessToRDSInstance
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-DisablePublicAccessToRDSInstance
        Version: "2012-10-17"
      PolicyName: RemediationRoleDisablePublicAccessToRDSInstanceSHARRMemberBasePolicyD50CB3CA
      Roles:
        - Ref: RemediationRoleDisablePublicAccessToRDSInstanceMemberAccountRole7E0A6680
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole DisablePublicAccessToRDSInstance/SHARR-Member-Base-Policy/Resource
  RemediationRoleDisablePublicAccessToRDSInstanceMemberAccountRole7E0A6680:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-DisablePublicAccessToRDSInstance
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
  SHARRRemediationPolicyEnableMinorVersionUpgradeOnRDSDBInstance8FBADA19:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - rds:DescribeDBInstances
              - rds:ModifyDBInstance
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: SHARRRemediationPolicyEnableMinorVersionUpgradeOnRDSDBInstance8FBADA19
      Roles:
        - Ref: RemediationRoleEnableMinorVersionUpgradeOnRDSDBInstanceMemberAccountRole66157FBF
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W12
            reason: Resource * is required for to allow remediation for any resource.
  RemediationRoleEnableMinorVersionUpgradeOnRDSDBInstanceSHARRMemberBasePolicyCB8B3F14:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ssm:GetParameters
              - ssm:GetParameter
              - ssm:PutParameter
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":ssm:*:"
                  - Ref: AWS::AccountId
                  - :parameter/Solutions/SO0111/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableMinorVersionUpgradeOnRDSDBInstance
          - Action:
              - ssm:StartAutomationExecution
              - ssm:GetAutomationExecution
              - ssm:DescribeAutomationStepExecutions
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :document/Solutions/SHARR-SO0111-EnableMinorVersionUpgradeOnRDSDBInstance
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - :ssm:*::automation-definition/*
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":ssm:*:"
                    - Ref: AWS::AccountId
                    - :automation-execution/*
          - Action: sts:AssumeRole
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":iam::"
                  - Ref: AWS::AccountId
                  - :role/SO0111-EnableMinorVersionUpgradeOnRDSDBInstance
        Version: "2012-10-17"
      PolicyName: RemediationRoleEnableMinorVersionUpgradeOnRDSDBInstanceSHARRMemberBasePolicyCB8B3F14
      Roles:
        - Ref: RemediationRoleEnableMinorVersionUpgradeOnRDSDBInstanceMemberAccountRole66157FBF
    Metadata:
      aws:cdk:path: MemberRoleStack/RemediationRole EnableMinorVersionUpgradeOnRDSDBInstance/SHARR-Member-Base-Policy/Resource
  RemediationRoleEnableMinorVersionUpgradeOnRDSDBInstanceMemberAccountRole66157FBF:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :role/SO0111-SHARR-Orchestrator-Member
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
                Fn::FindInMap:
                  - ServiceprincipalMap
                  - Ref: AWS::Region
                  - ssm
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              AWS:
                Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":iam::"
                    - Ref: AWS::AccountId
                    - :root
        Version: "2012-10-17"
      RoleName: SO0111-EnableMinorVersionUpgradeOnRDSDBInstance
    DependsOn:
      - OrchestratorMemberRoleMemberAccountRoleBE9AD9D5
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      cfn_nag:
        rules_to_suppress:
          - id: W11
            reason: Resource * is required due to the administrative nature of the solution.
          - id: W28
            reason: Static names chosen intentionally to provide integration in cross-account permissions
Mappings:
  ServiceprincipalMap:
    af-south-1:
      ssm: ssm.af-south-1.amazonaws.com
    ap-east-1:
      ssm: ssm.ap-east-1.amazonaws.com
    ap-northeast-1:
      ssm: ssm.amazonaws.com
    ap-northeast-2:
      ssm: ssm.amazonaws.com
    ap-northeast-3:
      ssm: ssm.amazonaws.com
    ap-south-1:
      ssm: ssm.amazonaws.com
    ap-southeast-1:
      ssm: ssm.amazonaws.com
    ap-southeast-2:
      ssm: ssm.amazonaws.com
    ap-southeast-3:
      ssm: ssm.ap-southeast-3.amazonaws.com
    ca-central-1:
      ssm: ssm.amazonaws.com
    cn-north-1:
      ssm: ssm.amazonaws.com
    cn-northwest-1:
      ssm: ssm.amazonaws.com
    eu-central-1:
      ssm: ssm.amazonaws.com
    eu-north-1:
      ssm: ssm.amazonaws.com
    eu-south-1:
      ssm: ssm.eu-south-1.amazonaws.com
    eu-south-2:
      ssm: ssm.eu-south-2.amazonaws.com
    eu-west-1:
      ssm: ssm.amazonaws.com
    eu-west-2:
      ssm: ssm.amazonaws.com
    eu-west-3:
      ssm: ssm.amazonaws.com
    me-south-1:
      ssm: ssm.me-south-1.amazonaws.com
    sa-east-1:
      ssm: ssm.amazonaws.com
    us-east-1:
      ssm: ssm.amazonaws.com
    us-east-2:
      ssm: ssm.amazonaws.com
    us-gov-east-1:
      ssm: ssm.amazonaws.com
    us-gov-west-1:
      ssm: ssm.amazonaws.com
    us-iso-east-1:
      ssm: ssm.amazonaws.com
    us-iso-west-1:
      ssm: ssm.us-iso-west-1.amazonaws.com
    us-isob-east-1:
      ssm: ssm.amazonaws.com
    us-west-1:
      ssm: ssm.amazonaws.com
    us-west-2:
      ssm: ssm.amazonaws.com

